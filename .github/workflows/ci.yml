name: ci
"on":
  - push
jobs:
  build:
    runs-on: ubuntu-20.04
    steps:
      - uses: actions/checkout@v2
      - uses: pnpm/action-setup@v2.0.1
        with:
          version: "7.11.0"
      - uses: actions/setup-node@v2
        with:
          node-version: "16.17.0"
      - run: pnpm i --frozen-lockfile
      - run: npm run lint:check
      - run: npm run tsc
      - run: npm run build
      - run: npm run package
      - run: ls -lh build
      # https://github.com/softprops/action-gh-release#%EF%B8%8F-uploading-release-assets
      - uses: softprops/action-gh-release@v1
        if: startsWith(github.ref, 'refs/tags/')
        with:
          files: |
            build/latest-linux.yml
            build/*.AppImage
